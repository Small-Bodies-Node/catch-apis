#!/bin/bash -eu

if [ ! -e .env ];
    cp .env-template .env
    echo "Created a new .env file.  Edit to suit your needs and re-run _build_env."
    exit 1
fi

source .env

$PYTHON_3_9_OR_HIGHER -m venv .venv --prompt=$APP_NAME
source .venv/bin/activate
pip install -q -U pip setuptools wheel

./_build_s2

pip install -e git+https://git@github.com/Small-Bodies-Node/sbsearch.git@main#egg=sbsearch
pip install -e git+https://git@github.com/Small-Bodies-Node/catch.git@main#egg=catch
pip install -e .

echo "Virtual environment is ready.  'source _activate' to use it."
